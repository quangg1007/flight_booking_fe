import{a as $,b as le,c as pt}from"./chunk-W5RC2HXO.js";import{a as L}from"./chunk-KTHKAOYV.js";import{$ as b,$b as Pe,Aa as Q,Ba as W,C as q,Ca as H,D as Re,Da as w,E as R,Ea as u,Eb as it,Fa as f,Fb as ne,Ga as T,Gb as nt,H as Z,Hb as ot,I as ge,Ib as ze,K as G,Kb as ye,Lb as B,M as y,Ma as Y,Mb as oe,N as fe,Na as J,Nb as re,Oa as K,Ob as rt,Pa as a,Pb as at,Qa as P,Qb as ae,Ra as g,Rb as ke,S as h,Sa as _e,Sb as lt,T as _,Ta as He,Tb as st,Ua as Ye,Ub as Ce,Va as Je,Vb as Se,Wb as we,Xa as z,Xb as Ee,Zb as Be,_ as U,_a as Ke,_b as Te,ab as Xe,ac as Ie,bb as ve,ca as Ge,cb as C,db as E,dc as mt,eb as et,fa as l,fb as X,g as ce,ga as x,h as $e,hb as ee,hc as dt,ia as k,ja as Ze,jb as te,ka as he,kb as be,lb as j,lc as ct,ma as v,mb as O,mc as ut,n as Me,na as Qe,nc as se,oa as m,p as F,qa as V,qb as ie,rb as tt,sa as We,ta as N,tb as D,u as Le,ub as xe,v as qe,va as A,wa as M,xa as o,ya as i,za as d}from"./chunk-YACVS6DH.js";function kt(r,p){if(r&1&&(o(0,"div",17),d(1,"input",14),o(2,"div",15),a(3),i(),o(4,"div",21)(5,"div",22)(6,"label",23),a(7,"Passenger First Name"),i(),d(8,"input",24),i(),o(9,"div",22)(10,"label",23),a(11,"Passenger Last Name"),i(),d(12,"input",25),i(),o(13,"div",22)(14,"label",23),a(15,"Passport Number"),i(),d(16,"input",26),i(),o(17,"div",22)(18,"label",23),a(19,"Passport Expiry"),i(),d(20,"input",27),i(),o(21,"div",22)(22,"label",23),a(23,"Date Of Birth"),i(),d(24,"input",28),i(),o(25,"div",22)(26,"label",23),a(27,"Street Address"),i(),d(28,"input",29),i()()()),r&2){let e=p.$implicit,t=p.$index;m("formGroupName",t),l(3),g(" Passenger ",t+1," "),l(5),T("value",e.first_name),l(4),T("value",e.last_name),l(4),T("value",e.passport_number),l(4),T("value",e.passport_expiry),l(4),T("value",e.date_of_birth),l(4),T("value",e.street_address)}}var De=(()=>{class r{constructor(e){this._fb=e,this.bookingData=b.required(),this.bookingDataChange=U(),this.formatedDepDes=b.required(),this.destroy$=new ce,te(()=>{this.bookingData()?.passengers.map(t=>[this.passengersFormArray.push(this.addPassengerForm(t))])})}ngOnInit(){this.initEmptyForm()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}initEmptyForm(){this.bookingForm=this._fb.group({passengers:this._fb.array([])})}get passengersFormArray(){return this.bookingForm.get("passengers")}addPassengerForm(e){return console.log("passenger: ",e),this._fb.group({passenger_id:[e?.passenger_id,B.required],first_name:[e?.first_name,B.required],last_name:[e?.last_name,B.required],date_of_birth:[e?.date_of_birth,B.required],passport_number:[e?.passport_number,B.required],passport_expiry:[e?.passport_expiry,B.required],street_address:[e?.street_address,B.required]})}confirmUpdateBooking(){let e=this.passengersFormArray.value.map(t=>({passenger_id:t.passenger_id,first_name:t.first_name,last_name:t.last_name,date_of_birth:t.date_of_birth,passport_number:t.passport_number,passport_expiry:t.passport_expiry,street_address:t.street_address}));this.bookingDataChange.emit(e)}closeDrawer(){let e=document.getElementById("booking-detail-drawer");e.checked=!1}static{this.\u0275fac=function(t){return new(t||r)(x(Be))}}static{this.\u0275cmp=y({type:r,selectors:[["app-booking-detail"]],inputs:{bookingData:[1,"bookingData"],formatedDepDes:[1,"formatedDepDes"]},outputs:{bookingDataChange:"bookingDataChange"},standalone:!0,features:[z],decls:37,vars:9,consts:[[1,"drawer--content","w-[800px]"],[1,"btn","btn-ghost","btn-circle","absolute","top-4","left-4",3,"click"],[1,"material-symbols-outlined"],[1,"p-8","mx-10"],[1,"text-2xl","font-bold","mb-6"],[1,"card","bg-base-100","shadow-xl","mb-6"],[1,"card-body"],[1,"flex","justify-between","items-center"],[1,"text-xl","font-bold"],[1,"text-sm","opacity-70"],[1,"text-right"],[1,"font-bold"],[1,"space-y-4",3,"formGroup"],[1,"collapse","collapse-arrow","bg-base-100"],["type","checkbox"],[1,"collapse-title","text-xl","font-medium","flex","items-center","gap-2"],["formArrayName","passengers",1,"collapse-content","flex","flex-col","gap-y-2"],[1,"collapse","collapse-arrow","bg-base-200",3,"formGroupName"],[1,"flex","justify-end","space-x-4","mt-6"],[1,"btn","btn-error","text-white",3,"click"],[1,"btn","btn-primary","text-white",3,"click"],[1,"collapse-content"],[1,"form-control"],[1,"label"],["type","text","formControlName","first_name",1,"input","input-bordered",3,"value"],["type","text","formControlName","last_name",1,"input","input-bordered",3,"value"],["type","text","formControlName","passport_number",1,"input","input-bordered",3,"value"],["type","text","formControlName","passport_expiry",1,"input","input-bordered",3,"value"],["type","text","formControlName","date_of_birth",1,"input","input-bordered",3,"value"],["type","text","formControlName","street_address",1,"input","input-bordered",3,"value"]],template:function(t,n){if(t&1&&(o(0,"div",0)(1,"button",1),u("click",function(){return n.closeDrawer()}),o(2,"span",2),a(3," arrow_left_alt "),i()(),o(4,"div",3)(5,"h2",4),a(6),i(),o(7,"div",5)(8,"div",6)(9,"div",7)(10,"div")(11,"h3",8),a(12,"Vietnam Airlines VN123"),i(),o(13,"p",9),a(14),i()(),o(15,"div",10)(16,"p",11),a(17),C(18,"weekMonthDay"),i(),o(19,"p",9),a(20),C(21,"timeFormat"),i()()()()(),o(22,"form",12)(23,"div",13),d(24,"input",14),o(25,"div",15)(26,"span",2),a(27," account_circle "),i(),a(28," Passenger Details "),i(),o(29,"div",16),A(30,kt,29,8,"div",17,N),i()()(),o(32,"div",18)(33,"button",19),u("click",function(){return n.closeDrawer()}),a(34," Cancel Changes "),i(),o(35,"button",20),u("click",function(){return n.confirmUpdateBooking()}),a(36," Save Changes "),i()()()()),t&2){let s,c,S,de;l(6),g(" Booking Reference: #",(s=n.bookingData())==null?null:s.booking_id," "),l(8),P(n.formatedDepDes()),l(3),g(" ",E(18,5,(c=n.bookingData())==null||c.itinerary==null||c.itinerary.legs[0]==null?null:c.itinerary.legs[0].departure_time)," "),l(3),g(" ",E(21,7,(S=n.bookingData())==null||S.itinerary==null||S.itinerary.legs[0]==null?null:S.itinerary.legs[0].departure_time)," "),l(2),m("formGroup",n.bookingForm),l(8),M((de=n.bookingData())==null?null:de.passengers)}},dependencies:[D,se,L,Pe,ae,ye,oe,re,ke,Ce,lt,st]})}}return r})();var me=(()=>{class r{constructor(){this.sharedDataSubject=new $e(null),this.sharedData$=this.sharedDataSubject.asObservable()}setSharedData(e){this.sharedDataSubject.next(e)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275prov=Z({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var Ct=(r,p,e)=>({flight:r,index:p,legInfo:e});function St(r,p){r&1&&H(0)}function wt(r,p){if(r&1&&v(0,St,1,0,"ng-container",6),r&2){let e=p.$implicit,t=p.$index,n=f(),s=K(12);m("ngTemplateOutlet",s)("ngTemplateOutletContext",Xe(2,Ct,e,t,n.leg()))}}function Et(r,p){r&1&&(o(0,"div",28),d(1,"div",29),i())}function Bt(r,p){if(r&1&&(o(0,"div",27)(1,"p"),a(2),i(),a(3," \u2022 "),o(4,"p"),a(5," Change planes in "),o(6,"strong"),a(7),i()()()),r&2){let e=f().index,t=f();l(2),P(t.layoverInfo()[e].duration),l(5),P(t.layoverInfo()[e].layoverAirport)}}function Tt(r,p){r&1&&(o(0,"div",28),d(1,"div",29),i())}function Pt(r,p){if(r&1&&(o(0,"div",7)(1,"div",8)(2,"div",9),d(3,"img",10),o(4,"p",11),a(5),i()(),o(6,"div",12)(7,"div",13),d(8,"div",14)(9,"div",15),i(),o(10,"div",16)(11,"time",17),a(12),C(13,"timeFormat"),i(),o(14,"p",18),a(15),i()()(),o(16,"div",19)(17,"span",20),a(18," travel "),i(),o(19,"p",21),a(20),C(21,"durationFormat"),i()(),o(22,"div",22)(23,"div",13)(24,"div",23),d(25,"div",15)(26,"div",14),i()(),o(27,"div",24)(28,"time",17),a(29),C(30,"timeFormat"),i(),o(31,"p",25),a(32),i()()()()(),v(33,Et,2,0,"div",26)(34,Bt,8,2,"div",27)(35,Tt,2,0,"div",26)),r&2){let e=p.flight,t=p.index,n=p.legInfo;l(3),T("src",e.aircraft.logoUrl,Ge),l(2),g(" ",e.aircraft.name," "),l(7),P(E(13,12,e.depature_time)),l(3),_e(" ",e.departureAirport.name," (",e.departureAirport.iata,") "),l(5),g(" ",E(21,14,e.duration_in_minutes)," "),l(9),P(E(30,16,e.arrival_time)),l(3),_e(" ",e.arrivalAirport.name," (",e.arrivalAirport.iata,") "),l(),m("ngIf",t<n.segments.length-1),l(),We(t<n.segments.length-1?34:-1),l(),m("ngIf",t<n.segments.length-1)}}var pe=(()=>{class r{constructor(){this.leg=b.required(),this.headerText=b("Depart"),this.layoverInfo=ee(()=>{let e=[];return this.leg().segments.map((t,n,s)=>{let c=t.arrivalAirport.name+" ("+t.arrivalAirport.iata+")";if(n<s.length-1){let S=s[n+1],de=dt(S.depature_time,t.arrival_time);e.push({duration:de,layoverAirport:c})}}),e})}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=y({type:r,selectors:[["app-leg-detail"]],inputs:{leg:[1,"leg"],headerText:[1,"headerText"]},standalone:!0,features:[z],decls:13,vars:8,consts:[["flightSegmentDetails",""],[1,"flex","flex-col","gap-2","pt-7","pb-12","rounded-xl","bg-neutral-200","w-full","border","border-black"],[1,"flex","flex-wrap","gap-10","justify-between","items-center","pr-3","pl-5","w-full","font-semibold","max-md:max-w-full"],[1,"self-stretch","my-auto","text-xl","text-gray-800","w-[206px]"],[1,"self-stretch","my-auto","text-base","text-zinc-500","w-[58px]"],[1,"w-full","h-0.5","bg-slate-400"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"flex","flex-row","justify-between","items-start","mt-5","w-full","max-md:max-w-full","px-4"],[1,"flex","flex-col","pl-11","mt-2.5","w-full","max-md:pl-5","max-md:max-w-full"],[1,"flex","gap-5","-ml-8","items-center","self-stretch","my-auto","min-w-[240px]"],["width","40","height","40",1,"object-contain","shrink-0",3,"src"],[1,"self-stretch","my-auto","text-sm","font-semibold","text-red-600","w-[100px]","whitespace-nowrap"],[1,"flex","flex-wrap","gap-10","items-start","pl-3","w-full","max-md:max-w-full"],[1,"flex","flex-col","w-3"],["aria-hidden","true",1,"flex","w-3","h-3","bg-white","rounded-full","border-2","border-cyan-600","border-solid","min-h-[12px]"],["aria-hidden","true",1,"flex","self-center","w-0.5","bg-cyan-600","min-h-[27px]"],[1,"flex","gap-9","items-center","text-lg","min-w-[240px]","w-[284px]"],[1,"self-stretch","my-auto","text-base","font-bold","text-zinc-600","w-[73px]","whitespace-nowrap"],[1,"self-stretch","my-auto","text-zinc-600","w-[178px]","whitespace-nowrap"],[1,"flex","flex-wrap","gap-10","items-center","mt-2.5","pl-1.5","w-full","text-sm","font-semibold","text-zinc-400","max-md:max-w-full"],[1,"material-symbols-outlined","text-black"],[1,"flex-1","shrink","gap-2.5","self-stretch","my-auto","min-w-[240px]","w-[284px]"],[1,"flex","gap-10","items-end","pl-3","mt-2.5","max-w-full","w-[332px]"],[1,"flex","flex-col","w-full"],[1,"flex","gap-8","items-center","min-w-[240px]"],[1,"self-stretch","my-auto","text-lg","text-zinc-500","w-[161px]","whitespace-nowrap"],["class","flex w-full justify-center items-center",4,"ngIf"],[1,"flex","flex-row","gap-2","ml-7","whitespace-nowrap","px-4"],[1,"flex","w-full","justify-center","items-center"],[1,"w-11/12","h-0.5","bg-slate-300"]],template:function(t,n){if(t&1&&(o(0,"section",1)(1,"header",2)(2,"h2",3),a(3),C(4,"date"),i(),o(5,"p",4),a(6),C(7,"durationFormat"),i()(),d(8,"div",5),A(9,wt,1,6,"ng-container",null,N),i(),v(11,Pt,36,18,"ng-template",null,0,X)),t&2){let s,c;l(3),_e(" ",n.headerText()," \xB7 ",et(4,3,(s=n.leg())==null?null:s.departure_time,"MMM d, y")," "),l(3),g(" ",E(7,6,(c=n.leg())==null?null:c.duration_in_minutes)," "),l(3),M(n.leg().segments)}},dependencies:[D,O,ie,tt,ut,L]})}}return r})();var It=["cancelBtn"],Dt=(r,p,e,t)=>({"badge-success":r,"badge-warning":p,"badge-error":e,"badge-info":t});function Ft(r,p){if(r&1&&d(0,"app-leg-detail",35),r&2){let e=p.$implicit,t=p.$index;m("leg",e)("headerText",t%2===0?"Depart":"Return")}}function Nt(r,p){if(r&1&&(o(0,"tr")(1,"td",32)(2,"div",33)(3,"div",34),A(4,Ft,1,2,"app-leg-detail",35,N),i()()()()),r&2){let e=f().$implicit;l(4),M(e==null||e.itinerary==null?null:e.itinerary.legs)}}function At(r,p){if(r&1){let e=w();o(0,"tr",19),u("click",function(){let n=h(e).$index,s=f(2);return _(s.toggleFlightDetails(n))}),o(1,"td")(2,"div",20)(3,"div",21)(4,"div",22),d(5,"img",23),i()(),o(6,"div")(7,"div",24),a(8),i(),o(9,"div",25),a(10),i()()()(),o(11,"td")(12,"div"),a(13),C(14,"weekMonthDay"),i(),o(15,"div",26),a(16),C(17,"timeFormat"),i()(),o(18,"td"),a(19),i(),o(20,"td")(21,"div",27),a(22),i()(),o(23,"td")(24,"div",28)(25,"label",29),u("click",function(n){let s=h(e),c=s.$implicit,S=s.$index;return f(2).setSelectedBooking(c,c==null?null:c.booking_id,S),_(n.stopPropagation())}),a(26,"Modify"),i(),o(27,"button",30,1),u("click",function(n){return h(e),_(n.stopPropagation())}),a(29," Cancel "),i()()()(),v(30,Nt,6,0,"tr",31)}if(r&2){let e=p.$implicit,t=p.$index,n=f(2);l(5),T("ngSrc",e==null||e.itinerary==null||e.itinerary.legs[0]==null||e.itinerary.legs[0].segments[0]==null?null:e.itinerary.legs[0].segments[0].aircraft.logoUrl),l(3),g(" ",e==null||e.itinerary==null||e.itinerary.legs[0]==null||e.itinerary.legs[0].segments[0]==null?null:e.itinerary.legs[0].segments[0].flight_number," "),l(2),g(" ",e==null||e.itinerary==null||e.itinerary.legs[0]==null||e.itinerary.legs[0].segments[0]==null?null:e.itinerary.legs[0].segments[0].aircraft.name," "),l(3),g(" ",E(14,13,e==null||e.itinerary==null||e.itinerary.legs[0]==null?null:e.itinerary.legs[0].departure_time)," "),l(3),g(" ",E(17,15,e==null||e.itinerary==null||e.itinerary.legs[0]==null?null:e.itinerary.legs[0].departure_time)," "),l(3),P(n.formatedDepDes()[t]),l(2),m("ngClass",ve(17,Dt,(e==null?null:e.status)==="approved",(e==null?null:e.status)==="pending",(e==null?null:e.status)==="rejected",(e==null?null:e.status)==="complete")),l(),g(" ",e==null?null:e.status," "),l(3),V("btn-disabled",(e==null?null:e.status)==="rejected"),l(2),m("disabled",(e==null?null:e.status)==="rejected"),Qe("booking-id",e==null?null:e.booking_id),l(3),m("ngIf",n.expandedIndex===t)}}function Mt(r,p){if(r&1){let e=w();Q(0),o(1,"button",36),u("click",function(){let n=h(e).index,s=f(2);return _(s.changePage(n+1))}),a(2),i(),W()}if(r&2){let e=p.index,t=f(2);l(),V("btn-active",t.currentPageUpcomingBooking()===e+1),l(),g(" ",e+1," ")}}function zt(r,p){r&1&&H(0)}function Ut(r,p){if(r&1){let e=w();o(0,"div",11),d(1,"input",12),o(2,"table",13)(3,"thead")(4,"tr")(5,"th"),a(6,"Flight"),i(),o(7,"th"),a(8,"Date & Time"),i(),o(9,"th"),a(10,"Route"),i(),o(11,"th"),a(12,"Status"),i(),o(13,"th"),a(14,"Actions"),i()()(),o(15,"tbody"),A(16,At,31,22,null,null,N),i()(),o(18,"div",14)(19,"div",15)(20,"button",16),u("click",function(){h(e);let n=f();return _(n.changePage(n.currentPageUpcomingBooking()-1))}),a(21," \xAB "),i(),v(22,Mt,3,3,"ng-container",17),o(23,"button",16),u("click",function(){h(e);let n=f();return _(n.changePage(n.currentPageUpcomingBooking()+1))}),a(24," \xBB "),i()()(),v(25,zt,1,0,"ng-container",18),i()}if(r&2){let e=f(),t=K(2);l(16),M(e.bookings()),l(4),m("disabled",e.currentPageUpcomingBooking()===1),l(2),m("ngForOf",e.getPagesArray()),l(),m("disabled",e.currentPageUpcomingBooking()===e.totalBookings()||e.totalBookings()===0),l(2),m("ngTemplateOutlet",t)}}function Vt(r,p){if(r&1){let e=w();o(0,"div",37),d(1,"label",38),o(2,"div",39)(3,"app-booking-detail",40),u("bookingDataChange",function(n){h(e);let s=f();return _(s.bookingDetailChange(n))}),i()()()}if(r&2){let e=f();l(3),m("bookingData",e.selectedBooking)("formatedDepDes",e.selectedFormatedDepDes)}}var Fe=(()=>{class r{constructor(){this.isLoading=b.required(),this.cancelButtons=he("cancelBtn"),this.bookings=b.required(),this.selectedBookingId=null,this.totalBookings=b.required(),this.currentPageChange=U(),this.pageSize=b.required(),this.currentPage=b.required(),this.currentPageUpcomingBooking=k(1),this.bookingsChanged=U(),this.BookingDetailChange=U(),this.formatedDepDes=ee(()=>this.bookings().map(e=>{if(e?.itinerary?.legs[0]?.segments[0]){let t=e?.itinerary.legs;if(t.length>1){let n="";return t.forEach((s,c)=>{n+=`${s.origin_iata} - ${s.destination_iata}${c<t.length-1?" | ":""}`}),n}else return`${e?.itinerary?.legs[0]?.origin_iata} - ${e?.itinerary?.legs[0]?.destination_iata}`}return""})),this.activeTab=b(),this.expandedIndex=-1,te(()=>{console.log("total Booking:",this.totalBookings()),this.cancelButtons().forEach((t,n)=>{let s=t.nativeElement.getAttribute("booking-id");t.nativeElement.addEventListener("click",()=>this.showModal(s))})})}showModal(e){this.selectedBookingId=e,document.getElementById("cancel_modal").showModal()}confirmCancel(){this.selectedBookingId&&this.bookingsChanged.emit(this.selectedBookingId)}toggleFlightDetails(e){this.expandedIndex=this.expandedIndex===e?-1:e}setSelectedBooking(e,t,n){this.selectedBooking=e,this.selectedBookingId=t,this.selectedFormatedDepDes=this.formatedDepDes()[n]}bookingDetailChange(e){this.BookingDetailChange.emit({booking_data:{passengers:e},booking_id:this.selectedBookingId})}changePage(e){this.currentPageUpcomingBooking.update(()=>e),this.currentPageChange.emit(e)}getPagesArray(){return this.totalBookings()===0?[0]:Array(this.totalBookings()).fill(0).map((e,t)=>t)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=y({type:r,selectors:[["app-upcoming-booking"]],viewQuery:function(t,n){t&1&&Y(n.cancelButtons,It,5),t&2&&J()},inputs:{isLoading:[1,"isLoading"],bookings:[1,"bookings"],totalBookings:[1,"totalBookings"],pageSize:[1,"pageSize"],currentPage:[1,"currentPage"],activeTab:[1,"activeTab"]},outputs:{currentPageChange:"currentPageChange",bookingsChanged:"bookingsChanged",BookingDetailChange:"BookingDetailChange"},standalone:!0,features:[z],decls:15,vars:1,consts:[["drawerSide",""],["cancelBtn",""],["class","overflow-x-auto drawer drawer-end",4,"ngIf"],["id","cancel_modal",1,"modal","modal-bottom","sm:modal-middle"],[1,"modal-box"],[1,"font-bold","text-lg"],[1,"py-4"],[1,"modal-action"],["method","dialog"],[1,"btn","btn-sm","btn-ghost"],[1,"btn","btn-sm","btn-error","text-white",3,"click"],[1,"overflow-x-auto","drawer","drawer-end"],["id","booking-detail-drawer","type","checkbox",1,"drawer-toggle"],[1,"table","table-zebra","w-full","drawer-content"],[1,"flex","justify-center","mt-4"],[1,"join"],[1,"join-item","btn","btn-sm",3,"click","disabled"],[4,"ngFor","ngForOf"],[4,"ngTemplateOutlet"],[1,"cursor-pointer","hover:bg-base-200",3,"click"],[1,"flex","items-center","space-x-3"],[1,"avatar"],[1,"mask","mask-squircle","w-12","h-12"],["fill","","alt","Airline",3,"ngSrc"],[1,"font-bold"],[1,"badge","bg-red-300","text-sm","opacity-50"],[1,"text-sm","opacity-50"],[1,"badge","text-white",3,"ngClass"],[1,"flex","space-x-2"],["for","booking-detail-drawer",1,"booking-detail-drawer","btn","btn-sm","drawer-button","btn-primary",3,"click"],[1,"cancel-btn","btn","btn-sm","btn-error","text-white",3,"click","disabled"],[4,"ngIf"],["colspan","6"],[1,"p-4","bg-base-100"],[1,"flex","flex-col","space-y-4"],[3,"leg","headerText"],[1,"join-item","btn","btn-sm",3,"click"],[1,"drawer-side"],["for","booking-detail-drawer",1,"drawer-overlay"],[1,"menu","p-4","w-[800px]","min-h-full","bg-base-200"],[3,"bookingDataChange","bookingData","formatedDepDes"]],template:function(t,n){if(t&1){let s=w();v(0,Ut,26,4,"div",2)(1,Vt,4,2,"ng-template",null,0,X),o(3,"dialog",3)(4,"div",4)(5,"h3",5),a(6,"Cancel Booking"),i(),o(7,"p",6),a(8,"Do you want to cancel this booking?"),i(),o(9,"div",7)(10,"form",8)(11,"button",9),a(12,"No"),i(),o(13,"button",10),u("click",function(){return h(s),_(n.confirmCancel())}),a(14," Yes "),i()()()()()}t&2&&m("ngIf",n.activeTab()==="upcoming")},dependencies:[D,be,j,O,ie,L,xe,se,De,pe]})}}return r})();var Ot=(r,p,e,t)=>({"badge-success":r,"badge-warning":p,"badge-error":e,"badge-info":t});function $t(r,p){if(r&1&&d(0,"app-leg-detail",24),r&2){let e=p.$implicit,t=p.$index;m("leg",e)("headerText",t%2===0?"Depart":"Return")}}function Lt(r,p){if(r&1&&(o(0,"tr")(1,"td",21)(2,"div",22)(3,"div",23),A(4,$t,1,2,"app-leg-detail",24,N),i()()()()),r&2){let e=f().$implicit;l(4),M(e==null||e.itinerary==null?null:e.itinerary.legs)}}function qt(r,p){if(r&1){let e=w();o(0,"tr",7),u("click",function(){let n=h(e).$index,s=f(2);return _(s.toggleFlightDetails(n))}),o(1,"td")(2,"div",8)(3,"div",9)(4,"div",10),d(5,"img",11),i()(),o(6,"div")(7,"div",12),a(8),i(),o(9,"div",13),a(10),i()()()(),o(11,"td")(12,"div"),a(13),C(14,"weekMonthDay"),i(),o(15,"div",14),a(16),C(17,"timeFormat"),i()(),o(18,"td"),a(19),i(),o(20,"td")(21,"div",15),a(22),i()(),o(23,"td")(24,"div",16)(25,"button",17)(26,"span",18),a(27," airplane_ticket "),i(),a(28," E-Ticket "),i(),o(29,"button",19)(30,"span",18),a(31," credit_card "),i(),a(32," Invoice "),i()()()(),v(33,Lt,6,0,"tr",20)}if(r&2){let e=p.$implicit,t=p.$index,n=f(2);l(5),T("ngSrc",e==null||e.itinerary==null||e.itinerary.legs[0]==null||e.itinerary.legs[0].segments[0]==null?null:e.itinerary.legs[0].segments[0].aircraft.logoUrl),l(3),g(" ",e==null||e.itinerary==null||e.itinerary.legs[0]==null||e.itinerary.legs[0].segments[0]==null?null:e.itinerary.legs[0].segments[0].flight_number," "),l(2),g(" ",e==null||e.itinerary==null||e.itinerary.legs[0]==null||e.itinerary.legs[0].segments[0]==null?null:e.itinerary.legs[0].segments[0].aircraft.name," "),l(3),g(" ",E(14,9,e==null||e.itinerary==null||e.itinerary.legs[0]==null?null:e.itinerary.legs[0].departure_time)," "),l(3),g(" ",E(17,11,e==null||e.itinerary==null||e.itinerary.legs[0]==null?null:e.itinerary.legs[0].departure_time)," "),l(3),P(n.formatedDepDes()[t]),l(2),m("ngClass",ve(13,Ot,(e==null?null:e.status)==="approved",(e==null?null:e.status)==="pending",(e==null?null:e.status)==="rejected",(e==null?null:e.status)==="complete")),l(),g(" ",e==null?null:e.status," "),l(11),m("ngIf",n.expandedIndex===t)}}function Rt(r,p){if(r&1){let e=w();Q(0),o(1,"button",25),u("click",function(){let n=h(e).index,s=f(2);return _(s.changePage(n+1))}),a(2),i(),W()}if(r&2){let e=p.index,t=f(2);l(),V("btn-active",t.currentPagePastBooking()===e+1),l(),g(" ",e+1," ")}}function Gt(r,p){if(r&1){let e=w();o(0,"div",1)(1,"table",2)(2,"thead")(3,"tr")(4,"th"),a(5,"Flight"),i(),o(6,"th"),a(7,"Date & Time"),i(),o(8,"th"),a(9,"Route"),i(),o(10,"th"),a(11,"Status"),i(),o(12,"th"),a(13,"Documents"),i()()(),o(14,"tbody"),A(15,qt,34,18,null,null,N),i()(),o(17,"div",3)(18,"div",4)(19,"button",5),u("click",function(){h(e);let n=f();return _(n.changePage(n.currentPagePastBooking()-1))}),a(20," \xAB "),i(),v(21,Rt,3,3,"ng-container",6),o(22,"button",5),u("click",function(){h(e);let n=f();return _(n.changePage(n.currentPagePastBooking()+1))}),a(23," \xBB "),i()()()()}if(r&2){let e=f();l(15),M(e.bookings()),l(4),m("disabled",e.currentPagePastBooking()===1),l(2),m("ngForOf",e.getPagesArray()),l(),m("disabled",e.currentPagePastBooking()===e.totalBookings()||e.totalBookings()===0)}}var Ne=(()=>{class r{constructor(){this.isLoading=b.required(),this.activeTab=b(),this.bookings=b.required(),this.totalBookings=b.required(),this.currentPageChange=U(),this.pageSize=b.required(),this.currentPage=b.required(),this.currentPagePastBooking=k(1),this.expandedIndex=-1,this.formatedDepDes=ee(()=>this.bookings().map(e=>{if(e?.itinerary?.legs[0]?.segments[0]){let t=e?.itinerary.legs;if(t.length>1){let n="";return t.forEach((s,c)=>{n+=`${s.origin_iata} - ${s.destination_iata}${c<t.length-1?" | ":""}`}),n}else return`${e?.itinerary?.legs[0]?.origin_iata} - ${e?.itinerary?.legs[0]?.destination_iata}`}return""})),te(()=>{console.log("total Booking:",this.totalBookings())})}toggleFlightDetails(e){this.expandedIndex=this.expandedIndex===e?-1:e}changePage(e){this.currentPagePastBooking.update(()=>e),this.currentPageChange.emit(e)}getPagesArray(){return this.totalBookings()===0?[0]:Array(this.totalBookings()).fill(0).map((e,t)=>t)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=y({type:r,selectors:[["app-past-booking"]],inputs:{isLoading:[1,"isLoading"],activeTab:[1,"activeTab"],bookings:[1,"bookings"],totalBookings:[1,"totalBookings"],pageSize:[1,"pageSize"],currentPage:[1,"currentPage"]},outputs:{currentPageChange:"currentPageChange"},standalone:!0,features:[z],decls:1,vars:1,consts:[["class","overflow-x-auto",4,"ngIf"],[1,"overflow-x-auto"],[1,"table","table-zebra","w-full"],[1,"flex","justify-center","mt-4"],[1,"join"],[1,"join-item","btn","btn-sm",3,"click","disabled"],[4,"ngFor","ngForOf"],[1,"cursor-pointer","hover:bg-base-200",3,"click"],[1,"flex","items-center","space-x-3"],[1,"avatar"],[1,"mask","mask-squircle","w-12","h-12"],["fill","","alt","Airline",3,"ngSrc"],[1,"font-bold"],[1,"badge","bg-red-300","text-sm","opacity-50"],[1,"text-sm","opacity-50"],[1,"badge","text-white",3,"ngClass"],[1,"flex","space-x-2"],["onclick","ticket_modal.showModal()",1,"btn","btn-sm","btn-outline"],[1,"material-symbols-outlined"],[1,"btn","btn-sm","btn-outline"],[4,"ngIf"],["colspan","6"],[1,"p-4","bg-base-100"],[1,"flex","flex-col","space-y-4"],[3,"leg","headerText"],[1,"join-item","btn","btn-sm",3,"click"]],template:function(t,n){t&1&&v(0,Gt,24,3,"div",0),t&2&&m("ngIf",n.activeTab()==="past")},dependencies:[D,be,j,O,se,L,xe,pe]})}}return r})();var Qt=[".booking-detail-drawer"];function Wt(r,p){r&1&&(o(0,"div",13)(1,"div"),d(2,"i",14),o(3,"span"),a(4,"Flight VN123 is scheduled to depart on time. Please arrive at the airport at least 2 hours before departure."),i()()())}var gt=(()=>{class r{constructor(e,t,n){this.router=e,this.bookingService=t,this.accountPageService=n,this.isLoading=k(!0),this.modifyButtonArray=he(".booking-detail-drawer"),this.bookings=k([]),this.upcomingBookings=k([]),this.pastBookings=k([]),this.pageSize=k(4),this.currentPageUpcoming=k(1),this.totalPageUpcomming=k(1),this.currentPagePast=k(1),this.totalPagePast=k(1),this.user_id=0,this.activeTab="upcoming",this.ticketUrl="https://c8.alamy.com/comp/2AFH8GT/vector-boarding-pass-modern-airline-ticket-for-a-flight-2AFH8GT.jpg"}ngOnInit(){console.log(Intl.DateTimeFormat().resolvedOptions().timeZone),this.accountPageService.sharedData$.pipe(F(e=>{this.user_id=e.user_id}),R(()=>{this.setupUpcomingPastBooking()})).subscribe()}setupUpcomingPastBooking(){this.bookingService.getUpcomingBookings(this.user_id,this.currentPageUpcoming(),this.pageSize()).subscribe(e=>{console.log("bookingData",e),this.upcomingBookings.set(e.bookings),this.totalPageUpcomming.set(Math.ceil(e.total/this.pageSize())),this.isLoading.set(!1)}),this.bookingService.getPastBookings(this.user_id,this.currentPagePast(),this.pageSize()).subscribe(e=>{this.pastBookings.set(e.bookings),this.totalPagePast.set(Math.ceil(e.total/this.pageSize())),this.isLoading.set(!1)})}downloadTicket(){window.open(this.ticketUrl,"_blank")}deleteBooking(e){console.log("bookingId",e),this.bookingService.removeBookingByUserIdAndBookingId(this.user_id,e).subscribe(t=>{t.status==200&&(this.bookings.set(this.bookings().filter(n=>parseInt(n.booking_id)!==parseInt(e))),console.log(this.bookings()))})}bookingDetailChange(e){console.log("bookingData",e),this.bookingService.updateBokingById(e.booking_id,e.booking_data).subscribe(t=>{console.log("booking",t)})}changePastBookingPage(e){this.currentPagePast.update(()=>e),console.log("upcoming page",e),this.bookingService.getPastBookings(this.user_id,this.currentPagePast(),this.pageSize()).subscribe(t=>{console.log("bookingData",t),this.pastBookings.set(t.bookings)})}changeUpcomingBookingPage(e){this.currentPageUpcoming.set(e),console.log("past page",e),this.bookingService.getUpcomingBookings(this.user_id,this.currentPageUpcoming(),this.pageSize()).subscribe(t=>{console.log("bookingData",t),this.upcomingBookings.set(t.bookings)})}static{this.\u0275fac=function(t){return new(t||r)(x(ne),x(ct),x(me))}}static{this.\u0275cmp=y({type:r,selectors:[["app-bookings"]],viewQuery:function(t,n){t&1&&Y(n.modifyButtonArray,Qt,5),t&2&&J()},decls:18,vars:18,consts:[[1,"space-y-8"],[1,"tabs","tabs-boxed"],[1,"tab","tab-lg",3,"click"],[3,"bookingsChanged","BookingDetailChange","currentPageChange","isLoading","bookings","totalBookings","pageSize","currentPage","activeTab"],[3,"currentPageChange","isLoading","activeTab","totalBookings","pageSize","currentPage","bookings"],["class","alert alert-info shadow-lg",4,"ngIf"],["id","ticket_modal",1,"modal"],[1,"modal-box","w-11/12","max-w-5xl"],[1,"font-bold","text-lg","mb-4"],["src",`
        https://www.shutterstock.com/image-vector/airplane-ticket-flight-boarding-pass-260nw-2278553741.jpg
      `,"alt","E-Ticket",1,"w-full"],[1,"modal-action"],["method","dialog"],[1,"btn"],[1,"alert","alert-info","shadow-lg"],[1,"fas","fa-info-circle"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"a",2),u("click",function(){return n.activeTab="upcoming"}),a(3,"Upcoming Bookings"),i(),o(4,"a",2),u("click",function(){return n.activeTab="past"}),a(5,"Past Bookings"),i()(),o(6,"app-upcoming-booking",3),u("bookingsChanged",function(c){return n.deleteBooking(c)})("BookingDetailChange",function(c){return n.bookingDetailChange(c)})("currentPageChange",function(c){return n.changeUpcomingBookingPage(c)}),i(),o(7,"app-past-booking",4),u("currentPageChange",function(c){return n.changePastBookingPage(c)}),i(),v(8,Wt,5,0,"div",5),i(),o(9,"dialog",6)(10,"div",7)(11,"h3",8),a(12,"E-Ticket #VN456"),i(),d(13,"img",9),o(14,"div",10)(15,"form",11)(16,"button",12),a(17,"Close"),i()()()()()),t&2&&(l(2),V("tab-active",n.activeTab==="upcoming"),l(2),V("tab-active",n.activeTab==="past"),l(2),m("isLoading",n.isLoading())("bookings",n.upcomingBookings())("totalBookings",n.totalPageUpcomming())("pageSize",n.pageSize())("currentPage",n.currentPageUpcoming())("activeTab",n.activeTab),l(),m("isLoading",n.isLoading())("activeTab",n.activeTab)("totalBookings",n.totalPagePast())("pageSize",n.pageSize())("currentPage",n.currentPageUpcoming())("activeTab",n.activeTab)("bookings",n.pastBookings()),l(),m("ngIf",n.activeTab==="upcoming"))},dependencies:[O,ae,re,rt,Fe,Ne]})}}return r})();var Ht=["timezoneModal"];function Yt(r,p){if(r&1&&(o(0,"option",10),a(1),i()),r&2){let e=p.$implicit;m("value",e),l(),P(e)}}var Ae=(()=>{class r{constructor(e,t){this.timezoneService=e,this.userService=t,this.selectedTimezone=k(Intl.DateTimeFormat().resolvedOptions().timeZone),this.modal=Ze("timezoneModal"),this.previousTimezone="",this.currentTimezone=k(""),this.timezones=Intl.supportedValuesOf("timeZone")}ngOnInit(){this.timezoneService.getCurrentTimezone().subscribe(e=>this.currentTimezone.set(e))}onTimezoneChange(e){this.previousTimezone=this.currentTimezone(),this.modal().nativeElement.showModal()}confirmTimezoneChange(e){e?this.userService.updateTimezonePreference(this.selectedTimezone()).subscribe({next:()=>{this.timezoneService.setTimezone(this.selectedTimezone()),this.modal().nativeElement.close()},error:()=>{}}):(this.timezoneService.setTimezone(this.selectedTimezone()),this.modal().nativeElement.close())}cancelTimezoneChange(){this.selectedTimezone.update(()=>this.previousTimezone),this.modal().nativeElement.close()}static{this.\u0275fac=function(t){return new(t||r)(x(pt),x(le))}}static{this.\u0275cmp=y({type:r,selectors:[["app-time-zone-settings"]],viewQuery:function(t,n){t&1&&Y(n.modal,Ht,5),t&2&&J()},standalone:!0,features:[z],decls:19,vars:3,consts:[["timezoneModal",""],[1,"timezone-settings","flex","flex-col","gap-2"],[1,"select","select-bordered","w-full","max-w-xs",3,"change","ngModelChange","ngModel","value"],[3,"value",4,"ngFor","ngForOf"],[1,"modal"],[1,"modal-box"],[1,"modal-action"],[1,"btn","btn-success","text-white",3,"click"],[1,"btn","btn-primary",3,"click"],[1,"btn",3,"click"],[3,"value"]],template:function(t,n){if(t&1){let s=w();o(0,"div",1)(1,"h3"),a(2,"Time Zone Settings"),i(),o(3,"select",2),u("change",function(S){return h(s),_(n.onTimezoneChange(S))}),Je("ngModelChange",function(S){return h(s),Ye(n.selectedTimezone,S)||(n.selectedTimezone=S),_(S)}),v(4,Yt,2,2,"option",3),i()(),o(5,"dialog",4,0)(7,"div",5)(8,"h3"),a(9,"Confirm Timezone Change"),i(),o(10,"p"),a(11,"Do you want to save this timezone preference to your profile?"),i(),o(12,"div",6)(13,"button",7),u("click",function(){return h(s),_(n.confirmTimezoneChange(!0))}),a(14," Save to Profile "),i(),o(15,"button",8),u("click",function(){return h(s),_(n.confirmTimezoneChange(!1))}),a(16," Keep Locally Only "),i(),o(17,"button",9),u("click",function(){return h(s),_(n.cancelTimezoneChange())}),a(18,"Cancel"),i()()()()}t&2&&(l(3),He("ngModel",n.selectedTimezone),m("value",n.currentTimezone()),l(),m("ngForOf",n.timezones))},dependencies:[D,j,Te,we,Ee,Se,oe,at]})}}return r})();var ht=(()=>{class r{constructor(e,t,n,s){this.fb=e,this.authService=t,this.userService=n,this.accountPageService=s,this.isEditing=!1,this.formSubmit$=new ce,this.destroy$=new ce,this.dataEmail=""}ngOnInit(){this.initPasswordForm(),this.initUserForm(),this.getUserProfile(),this.formSubmit$.pipe(R(()=>this.userForm.markAsDirty()),q(()=>mt(this.userForm)),Le(e=>(console.log(e),e)),Re(this.destroy$)).subscribe(()=>this.saveChanges())}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}patchUserForm(e){this.userForm.patchValue({firstName:e[0].first_name,lastName:e[0].last_name,dateOfBirth:new Date(e[0].date_of_birth).toISOString().split("T")[0],gender:e[0].gender,email:e[0].email,phoneNumber:e[0].phone_number,passportNumber:e[0].passport_number,passportExpiry:e[0].passport_expiry,nationality:e[0].nationality,streetAddress:e[0].street_address,city:e[0].city,country:e[0].country,postalCode:e[0].postal_code})}initUserForm(){this.userForm=this.fb.group({firstName:[{value:"",disabled:!0}],lastName:[{value:"",disabled:!0}],dateOfBirth:[{value:"",disabled:!0}],gender:[{value:"male",disabled:!0}],email:[{value:"",disabled:!0}],phoneNumber:[{value:"",disabled:!0}],passportNumber:[{value:"AB123456",disabled:!0}],passportExpiry:[{value:"2025-12-31",disabled:!0}],nationality:[{value:"United States",disabled:!0}],streetAddress:[{value:"123 Main Street",disabled:!0}],city:[{value:"New York",disabled:!0}],country:[{value:"United States",disabled:!0}],postalCode:[{value:"10001",disabled:!0}]})}toggleEdit(){this.isEditing=!this.isEditing,this.isEditing?this.userForm.enable():(this.userForm.disable(),this.saveChanges())}saveChanges(){console.log("submit form");let e=this.userForm.get("email")?.value,t=Object.keys(this.userForm.controls).filter(n=>this.userForm.get(n)?.dirty).reduce((n,s)=>{let c=this.getBackendFieldName(s);return n[c]=this.userForm.get(s)?.value,n},{});Object.keys(t).length>0&&(console.log(this.dataEmail),this.userService.updateUser(e,t).subscribe(n=>{console.log(t),console.log(n)}))}getBackendFieldName(e){return e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`)}getUserProfile(){this.accountPageService.sharedData$.pipe(F(e=>(this.dataEmail=e.email,e.email)),q(e=>this.userService.getUserByEmail(e).pipe(R(t=>{this.patchUserForm(t)})))).subscribe()}initPasswordForm(){this.passwordForm=this.fb.group({currentPassword:["",B.required],newPassword:["",[B.required,B.minLength(8)]],confirmPassword:["",B.required],verificationCode:["",B.required]},{validator:this.passwordMatchValidator})}passwordMatchValidator(e){return e.get("newPassword")?.value===e.get("confirmPassword")?.value?null:{mismatch:!0}}sendVerificationCode(){}updatePassword(){this.passwordForm.valid}static{this.\u0275fac=function(t){return new(t||r)(x(Be),x($),x(le),x(me))}}static{this.\u0275cmp=y({type:r,selectors:[["app-profile"]],decls:118,vars:15,consts:[[1,"space-y-8",3,"formGroup"],[1,"card","bg-base-100","shadow-xl"],[1,"card-body"],[1,"card-title","text-2xl","mb-4"],[1,"material-symbols-outlined"],[1,"grid","grid-cols-2","gap-4"],[1,"form-control"],[1,"label"],["type","text","formControlName","firstName",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","lastName",1,"input","input-bordered",3,"readonly"],["type","date","formControlName","dateOfBirth",1,"input","input-bordered",3,"readonly"],["formControlName","gender",1,"select","select-bordered"],["value","male"],["value","female"],["value","other"],["type","email","formControlName","email",1,"input","input-bordered",3,"readonly"],["type","tel","formControlName","phoneNumber",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","passportNumber",1,"input","input-bordered",3,"readonly"],["type","date","formControlName","passportExpiry",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","nationality",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","streetAddress",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","city",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","country",1,"input","input-bordered",3,"readonly"],["type","text","formControlName","postalCode",1,"input","input-bordered",3,"readonly"],[1,"flex","justify-end"],[1,"btn","btn-primary",3,"click"],[3,"ngSubmit","formGroup"],[1,"space-y-8"],["type","password","formControlName","currentPassword",1,"input","input-bordered"],["type","password","formControlName","newPassword",1,"input","input-bordered"],["type","password","formControlName","confirmPassword",1,"input","input-bordered"],[1,"flex","gap-2"],["type","text","formControlName","verificationCode",1,"input","input-bordered"],["type","button",1,"btn","btn-primary",3,"click"],[1,"flex","justify-end","mt-4"],["type","submit",1,"btn","btn-primary"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3)(4,"span",4),a(5," account_circle "),i()(),o(6,"div",5)(7,"div",6)(8,"label",7),a(9,"First Name"),i(),d(10,"input",8),i(),o(11,"div",6)(12,"label",7),a(13,"Last Name"),i(),d(14,"input",9),i(),o(15,"div",6)(16,"label",7),a(17,"Date of Birth"),i(),d(18,"input",10),i(),o(19,"div",6)(20,"label",7),a(21,"Gender"),i(),o(22,"select",11)(23,"option",12),a(24,"Male"),i(),o(25,"option",13),a(26,"Female"),i(),o(27,"option",14),a(28,"Other"),i()()(),o(29,"div",6)(30,"label",7),a(31,"Email Address"),i(),d(32,"input",15),i(),o(33,"div",6)(34,"label",7),a(35,"Phone Number"),i(),d(36,"input",16),i()()()(),o(37,"div",1)(38,"div",2)(39,"h2",3)(40,"span",4),a(41," airplane_ticket "),i()(),o(42,"div",5)(43,"div",6)(44,"label",7),a(45,"Passport Number"),i(),d(46,"input",17),i(),o(47,"div",6)(48,"label",7),a(49,"Passport Expiry Date"),i(),d(50,"input",18),i(),o(51,"div",6)(52,"label",7),a(53,"Nationality"),i(),d(54,"input",19),i()()()(),o(55,"div",1)(56,"div",2)(57,"h2",3)(58,"span",4),a(59," home "),i()(),o(60,"div",5)(61,"div",6)(62,"label",7),a(63,"Street Address"),i(),d(64,"input",20),i(),o(65,"div",6)(66,"label",7),a(67,"City"),i(),d(68,"input",21),i(),o(69,"div",6)(70,"label",7),a(71,"Country"),i(),d(72,"input",22),i(),o(73,"div",6)(74,"label",7),a(75,"Postal Code"),i(),d(76,"input",23),i()()()(),o(77,"div",24)(78,"button",25),u("click",function(){return n.toggleEdit()}),o(79,"span",4),a(80," edit "),i(),a(81),i()()(),o(82,"form",26),u("ngSubmit",function(){return n.updatePassword()}),o(83,"div",27)(84,"div",1)(85,"div",2)(86,"h2",3)(87,"span",4),a(88," vpn_key "),i(),a(89," Password Update "),i(),o(90,"div",5)(91,"div",6)(92,"label",7),a(93,"Current Password"),i(),d(94,"input",28),i(),o(95,"div",6)(96,"label",7),a(97,"New Password"),i(),d(98,"input",29),i(),o(99,"div",6)(100,"label",7),a(101,"Confirm New Password"),i(),d(102,"input",30),i(),o(103,"div",6)(104,"label",7),a(105,"Email Verification Code"),i(),o(106,"div",31),d(107,"input",32),o(108,"button",33),u("click",function(){return n.sendVerificationCode()}),a(109," Send Code "),i()()()()()(),o(110,"div",34)(111,"button",35)(112,"span",4),a(113," edit "),i(),a(114," Update Password "),i()()()(),o(115,"div",1)(116,"div",2),d(117,"app-time-zone-settings"),i()()),t&2&&(m("formGroup",n.userForm),l(10),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(14),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(10),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(10),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(4),m("readonly",!n.isEditing),l(5),g(" ",n.isEditing?"Save Changes":"Edit Profile"," "),l(),m("formGroup",n.passwordForm))},dependencies:[ae,we,Ee,ye,Se,oe,re,ke,Ce,Ae]})}}return r})();var Xt=r=>({$implicit:r});function ei(r,p){r&1&&H(0)}function ti(r,p){if(r&1&&(Q(0),v(1,ei,1,0,"ng-container",9),W()),r&2){let e=p.$implicit;f();let t=K(14);l(),m("ngTemplateOutlet",t)("ngTemplateOutletContext",Ke(2,Xt,e))}}function ii(r,p){if(r&1&&(o(0,"a",10)(1,"span",7),a(2),i(),a(3),i()),r&2){let e=p.$implicit;m("routerLink",e.path),l(2),g(" ",e.icon," "),l(),g(" ",e.label," ")}}var _t=(()=>{class r{constructor(e,t,n,s){this.userService=e,this.tokenService=t,this.accountPageService=n,this.authService=s,this.navItems=[{path:"profile",icon:"account_circle",label:"Profile"},{path:"bookings",icon:"airplane_ticket",label:"My Bookings"},{path:"payment-methods",icon:"credit_card",label:"Payment Methods"}]}ngOnInit(){this.authService.getDataFromAccessToken().pipe(F(e=>{this.accountPageService.setSharedData({user_id:e.user_id,email:e.email,role:e.role})})).subscribe()}logout(){let e=this.tokenService.getAccessToken(),t;e&&(t=JSON.parse(atob(e.split(".")[1])));let n=t.email;console.log(t),this.userService.logout(n).pipe(R(()=>{this.tokenService.clearTokens(),window.location.reload()})).subscribe()}static{this.\u0275fac=function(t){return new(t||r)(x(le),x(Ie),x(me),x($))}}static{this.\u0275cmp=y({type:r,selectors:[["app-account"]],decls:15,vars:1,consts:[["navItem",""],[1,"flex","min-h-screen","bg-base-100"],[1,"w-64","bg-base-200","p-4"],[1,"flex","flex-col","space-y-2"],[1,"text-xl","font-bold","mb-4"],[4,"ngFor","ngForOf"],[1,"btn","btn-outline","btn-ghost","border-red-500","text-red-500","justify-start",3,"click"],[1,"material-symbols-outlined"],[1,"flex-1","p-8"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["routerLinkActive","bg-primary text-primary-content",1,"btn","btn-ghost","justify-start",3,"routerLink"]],template:function(t,n){if(t&1){let s=w();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2",4),a(4,"My Account"),i(),v(5,ti,2,4,"ng-container",5),o(6,"button",6),u("click",function(){return h(s),_(n.logout())}),o(7,"span",7),a(8," logout "),i(),o(9,"span"),a(10,"Logout"),i()()()(),o(11,"div",8),d(12,"router-outlet"),i()(),v(13,ii,4,3,"ng-template",null,0,X)}t&2&&(l(5),m("ngForOf",n.navItems))},dependencies:[j,ie,it,nt,ot]})}}return r})();var vt=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=y({type:r,selectors:[["app-payments"]],decls:2,vars:0,template:function(t,n){t&1&&(o(0,"p"),a(1,"payments works!"),i())}})}}return r})();var bt=(()=>{class r{constructor(e,t){this.authService=e,this.router=t}canActivate(e,t){return this.authService.isAuthenticated().pipe(q(n=>this.authService.getDataFromAccessToken().pipe(F(s=>{console.log(s);let c=e.data.expectedRole.includes(s.role);return!n||!c?(this.router.navigate(["/login"]),!1):!0}))))}static{this.\u0275fac=function(t){return new(t||r)(G($),G(ne))}}static{this.\u0275prov=Z({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var xt=(()=>{class r{constructor(e,t,n){this.authService=e,this.router=t,this.tokenService=n}canActivate(e,t){return this.authService.isAuthenticated().pipe(q(n=>(console.log(n),n?Me(!0):this.authService.refreshToken().pipe(F(s=>(console.log(s),s.accessToken?(this.tokenService.setAccessToken(s.accessToken),!0):this.router.createUrlTree(["/login"]))),qe(()=>Me(this.router.createUrlTree(["/login"])))))))}static{this.\u0275fac=function(t){return new(t||r)(G($),G(ne),G(Ie))}}static{this.\u0275prov=Z({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var ni=[{path:"",component:_t,canActivate:[bt,xt],data:{expectedRole:["user","admin"]},children:[{path:"",redirectTo:"profile",pathMatch:"full"},{path:"profile",component:ht},{path:"bookings",component:gt},{path:"payment-methods",component:vt}]}],yt=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=fe({type:r})}static{this.\u0275inj=ge({imports:[ze.forChild(ni),ze]})}}return r})();var Fn=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=fe({type:r})}static{this.\u0275inj=ge({imports:[D,yt,Te,Pe,De,Fe,Ne,pe,Ae]})}}return r})();export{Fn as AccountModule};
