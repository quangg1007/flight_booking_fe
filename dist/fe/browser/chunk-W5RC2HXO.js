import{Fb as f,H as s,K as n,ac as d,bc as o,cc as l,g as u,h as m,n as i,p as a,v as c,xb as h}from"./chunk-YACVS6DH.js";var $=(()=>{class r{constructor(t,e,p){this.http=t,this.tokenService=e,this.router=p}sendEmailResetPassword(t){return this.http.post(`${o}/auth/request-password-reset`,{email:t})}validateToken(t){return this.http.post(`${o}/auth/password/edit`,{token:t})}resetPassword(t,e){return this.http.post(`${o}/auth/reset-password`,{token:t,password:e})}isAuthenticated(){let t=this.tokenService.getAccessToken();if(!t)return i(!1);let p=!!JSON.parse(atob(t.split(".")[1])).email;return i(p)}isTokenExpired(){let t=this.tokenService.getAccessToken();if(!t)return!0;let e=JSON.parse(atob(t.split(".")[1]));return Date.now()>=e.exp*1e3}refreshToken(){return this.http.post(`${o}/auth/refresh`,{},{withCredentials:!0,headers:{Authorization:`Bearer ${this.tokenService.getAccessToken()}`}})}isRefreshTokenExpired(){return this.http.get(`${o}/auth/check-refresh-token`,{withCredentials:!0}).pipe(a(t=>(console.log(t),!!t.expired)),c(()=>i(!0)))}getDataFromAccessToken(){let t=this.tokenService.getAccessToken();if(!t)return i(null);let e=JSON.parse(atob(t.split(".")[1]));return i(e)}static{this.\u0275fac=function(e){return new(e||r)(n(h),n(d),n(f))}}static{this.\u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();var y=(()=>{class r{constructor(t){this.http=t,this.$refreshToken=new u,this.$refreshTokenReceived=new u}validateEmail(t){return console.log("Trigger API call"),this.checkEmailExists(t).pipe(a(e=>!!e),c(e=>(console.log(e),i(!1))))}checkEmailExists(t){return this.http.get(`${o}/users/search`,{params:{email:t}})}register(t){return this.http.post(`${o}/auth/register`,t)}login(t){return this.http.post(`${o}/auth/login`,t,{withCredentials:!0})}logout(t){return this.http.post(`${o}/auth/logout`,t,{withCredentials:!0})}getUserByEmail(t){return this.http.get(`${o}/users/search`,{params:{email:t}})}updateUser(t,e){return console.log(t),this.http.patch(`${o}/users`,e,{params:{email:t}})}updateTimezonePreference(t){return this.http.patch(`${o}/users/timezone`,{timezone:t})}static{this.\u0275fac=function(e){return new(e||r)(n(h))}}static{this.\u0275prov=s({token:r,factory:r.\u0275fac})}}return r})();var z=(()=>{class r{constructor(){this.currentTimezone=new m(this.getDefaultTimezone())}getCurrentTimezone(){return this.currentTimezone.asObservable()}setTimezone(t){localStorage.setItem(l,t),this.currentTimezone.next(t)}getDefaultTimezone(){return localStorage.getItem(l)||Intl.DateTimeFormat().resolvedOptions().timeZone}static{this.\u0275fac=function(e){return new(e||r)}}static{this.\u0275prov=s({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{$ as a,y as b,z as c};
