<div class="flex relative flex-col bg-slate-200">
  <img
    loading="lazy"
    src="https://cdn.builder.io/api/v1/image/assets/TEMP/f7b6b2931a5ba543da034a16e2dcc32321625dcb98cef54c0d19c43197e5314e?apiKey=6b158420ea1148c682b1835c67783cca&"
    alt=""
    class="object-contain absolute inset-0 size-full"
  />

  <form
    class="flex relative flex-row gap-10 justify-center m-auto"
    autocomplete="off"
    [formGroup]="flighSearchForm"
    (ngSubmit)="submitForm()"
  >
    <section
      class="flex flex-col self-stretch my-auto text-black whitespace-nowrap w-[173px]"
    >
      <div class="row-control">
        <label class="form-control w-full max-w-xs relative">
          <div class="label flex gap-2 justify-start">
            <span class="label-text">Depature</span>
            <span class="material-symbols-outlined"> flight_takeoff </span>
          </div>
          <input
            type="text"
            placeholder="Ha Noi"
            class="input input-bordered w-full max-w-xs"
            id="from_departure"
            formControlName="from_departure"
            name="from_departure"
            required
          />

          <ng-container
            *ngTemplateOutlet="
              autocompleteTemplate;
              context: { results: fromResults, field: 'from_departure' }
            "
          ></ng-container>

          <div class="label">
            <span
              class="error-message label-text-alt text-red-600"
              *ngIf="
                flighSearchForm.get('from_departure')?.invalid &&
                (flighSearchForm.get('from_departure')?.dirty ||
                  flighSearchForm.get('from_departure')?.touched)
              "
            >
              {{ getErrorMessage("from_departure") }}
            </span>
          </div>
        </label>
      </div>

      <figure
        class="flex flex-col p-2 mt-7 text-lg bg-white rounded-xl h-[171px] w-[171px]"
      >
        <img
          loading="lazy"
          src="https://cdn.builder.io/api/v1/image/assets/TEMP/d4438f2f2f0d4e1b80b2a07ec4bc458cd606a527405112f27a29a1b4bc9eda8e?apiKey=6b158420ea1148c682b1835c67783cca&"
          alt="Hanoi cityscape"
          class="object-contain rounded-xl aspect-[1.3] w-[157px]"
        />
        <figcaption class="mt-2.5">Hanoi</figcaption>
      </figure>
    </section>

    <div
      class="flex relative gap-2.5 justify-center items-start self-stretch px-12 py-20 my-auto min-h-[591px] min-w-[240px] w-[479px] max-md:px-5 max-md:max-w-full"
    >
      <img
        loading="lazy"
        src="https://cdn.builder.io/api/v1/image/assets/TEMP/3dd1ba8dd670d19287ef667409c5adca6a3fd1f7e65741a52893e3082a10a766?apiKey=6b158420ea1148c682b1835c67783cca&"
        alt=""
        class="object-contain absolute top-2/4 left-2/4 z-0 self-start -translate-x-2/4 -translate-y-2/4 aspect-[0.81] h-[591px] min-w-[240px] w-[479px] max-md:max-w-full"
      />
      <div class="flex z-0 flex-col my-auto min-w-[240px] w-[382px]">
        <div class="flex gap-10 items-center self-center">
          <!-- One way Option -->

          <button
            type="button"
            class="flex gap-2 items-center self-stretch px-1.5 pt-1.5 pb-1.5 my-auto bg-white min-h-[142px] rounded-[100px] w-[78px]"
            [ngClass]="
              selectedFlightType === 'oneWay' ? 'flex-col' : 'flex-col-reverse'
            "
            (click)="selectFlightType('oneWay')"
          >
            <div
              class="flex gap-2.5 items-center justify-center border border-solid border-stone-300 h-[66px] min-h-[66px] rounded-[33px] shadow-[0px_4px_4px_rgba(0,0,0,0.25)] w-[66px] max-md:pl-5"
              [ngClass]="
                selectedFlightType === 'oneWay' ? 'bg-[#97C1CE]' : 'bg-white'
              "
              aria-label="Select multi-city flight"
            >
              <span
                class="material-symbols-outlined"
                [ngClass]="selectedFlightType === 'oneWay' ? 'text-white' : ''"
              >
                flight
              </span>
            </div>
            <div class="mt-1.5 text-xl text-center text-black">One way</div>
          </button>

          <!-- Round trip Option -->
          <button
            type="button"
            class="flex gap-2 items-center self-stretch px-1.5 pt-1.5 pb-1.5 my-auto bg-white min-h-[142px] rounded-[100px] w-[78px]"
            [ngClass]="
              selectedFlightType === 'roundTrip'
                ? 'flex-col'
                : 'flex-col-reverse'
            "
            (click)="selectFlightType('roundTrip')"
          >
            <div
              class="flex gap-2.5 items-center justify-center border border-solid border-stone-300 h-[66px] min-h-[66px] rounded-[33px] shadow-[0px_4px_4px_rgba(0,0,0,0.25)] w-[66px] max-md:pl-5"
              [ngClass]="
                selectedFlightType === 'roundTrip' ? 'bg-[#97C1CE]' : 'bg-white'
              "
            >
              <span
                class="material-symbols-outlined"
                [ngClass]="
                  selectedFlightType === 'roundTrip' ? 'text-white' : ''
                "
              >
                connecting_airports
              </span>
            </div>
            <div class="my-1.5 text-xl text-center text-black">Round Trip</div>
          </button>

          <!-- Multi city Option -->
          <button
            type="button"
            class="flex gap-2 items-center self-stretch px-1.5 pt-1.5 pb-1.5 my-auto bg-white min-h-[142px] rounded-[100px] w-[78px]"
            [ngClass]="
              selectedFlightType === 'multiCity'
                ? 'flex-col'
                : 'flex-col-reverse'
            "
            (click)="selectFlightType('multiCity')"
          >
            <div
              class="flex gap-2.5 items-center justify-center border border-solid border-stone-300 h-[66px] min-h-[66px] rounded-[33px] shadow-[0px_4px_4px_rgba(0,0,0,0.25)] w-[66px] max-md:pl-5"
              [ngClass]="
                selectedFlightType === 'multiCity' ? 'bg-[#97C1CE]' : 'bg-white'
              "
            >
              <span
                class="material-symbols-outlined"
                [ngClass]="
                  selectedFlightType === 'multiCity' ? 'text-white' : ''
                "
              >
                language
              </span>
            </div>
            <div class="my-1.5 text-xl text-center text-black">Multi City</div>
          </button>
        </div>

        <!-- Date -->
        <div
          class="flex gap-10 items-center px-4 mt-3.5 w-full bg-white rounded-xl min-h-[95px]"
        >
          <!-- <div class="flex flex-col self-stretch my-auto w-[120px]">
            <label
              for="departureDate"
              class="text-base text-black text-opacity-60"
              >Departure Date</label
            >
            <div class="flex flex-col mt-2 w-full text-black whitespace-nowrap">
              <div class="text-xl font-bold" id="departureDate">24/02/2024</div>
              <div class="text-base">Saturday</div>
            </div>
          </div> -->

          <div class="row-control flex flex-col self-stretch my-auto w-[120px]">
            <label class="form-control w-full max-w-xs">
              <div class="label flex gap-2 justify-start">
                <span class="label-text">Date</span>
                <span class="material-symbols-outlined"> calendar_today </span>
              </div>
              <input
                type="date"
                placeholder="Today"
                class="input input-bordered w-full max-w-xs"
                id="date"
                formControlName="date"
                name="date"
                required
              />
              <div class="label">
                <span
                  class="error-message label-text-alt text-red-600"
                  *ngIf="
                    flighSearchForm.get('date')?.invalid &&
                    (flighSearchForm.get('date')?.dirty ||
                      flighSearchForm.get('date')?.touched)
                  "
                >
                  {{ getErrorMessage("date") }}
                </span>
              </div>
            </label>
          </div>

          <div
            class="shrink-0 self-stretch my-auto w-0 border border-black border-solid h-[95px]"
          ></div>
          <div class="flex flex-col self-stretch my-auto w-[126px]">
            <label for="returnDate" class="text-base text-black text-opacity-60"
              >Return Date</label
            >
            <button
              type="button"
              id="returnDate"
              class="mt-2 text-xl font-bold text-black"
            >
              Tap to select
            </button>
          </div>
        </div>

        <!-- Class and Traveller -->
        <div
          class="flex gap-10 items-center px-3 mt-3.5 w-full bg-white rounded-xl min-h-[95px]"
        >
          <div
            class="flex flex-col self-stretch my-auto whitespace-nowrap w-[122px]"
          >
            <label
              for="classSelect"
              class="text-base text-black text-opacity-60"
              >Class</label
            >
            <div
              class="flex gap-2 items-center mt-2 w-full text-xl font-bold text-black"
            >
              <select
                id="classSelect"
                class="self-stretch my-auto w-[90px] bg-transparent border-none appearance-none"
              >
                <option>Business</option>
              </select>
              <img
                loading="lazy"
                src="https://cdn.builder.io/api/v1/image/assets/TEMP/e82ef87a6c75d7c536eca738ac545d27736a22b2d9c8e912e4ef127e2febfc2e?apiKey=6b158420ea1148c682b1835c67783cca&"
                alt=""
                class="object-contain shrink-0 self-stretch my-auto w-6 aspect-square"
              />
            </div>
          </div>
          <div
            class="shrink-0 self-stretch my-auto w-0 border border-black border-solid h-[95px]"
          ></div>
          <div class="flex flex-col self-stretch my-auto w-[130px]">
            <label
              for="travelerSelect"
              class="text-base text-black text-opacity-60"
              >Traveler</label
            >
            <div
              class="flex gap-2 items-center mt-2 w-full text-xl font-bold text-black"
            >
              <select
                id="travelerSelect"
                class="self-stretch my-auto w-[98px] bg-transparent border-none appearance-none"
              >
                <option>2 Traveler</option>
              </select>
              <img
                loading="lazy"
                src="https://cdn.builder.io/api/v1/image/assets/TEMP/e82ef87a6c75d7c536eca738ac545d27736a22b2d9c8e912e4ef127e2febfc2e?apiKey=6b158420ea1148c682b1835c67783cca&"
                alt=""
                class="object-contain shrink-0 self-stretch my-auto w-6 aspect-square"
              />
            </div>
          </div>
        </div>

        <!--  Search Button -->
        <button
          class="flex gap-2.5 items-center self-center p-5 mt-3.5 bg-slate-400 h-[60px] min-h-[60px] rounded-[30px] w-[60px]"
          aria-label="Search flights"
          type="submit"
          [disabled]="flighSearchForm.invalid"
        >
          <img
            loading="lazy"
            src="https://cdn.builder.io/api/v1/image/assets/TEMP/c098bad9e157aa5619a60bca49c2b2fa87b23778789a4494405b1b974069d7c2?apiKey=6b158420ea1148c682b1835c67783cca&"
            alt=""
            class="object-contain self-stretch my-auto w-6 aspect-square"
          />
        </button>
      </div>
    </div>

    <section
      class="flex flex-col self-stretch my-auto text-black whitespace-nowrap min-w-[240px] w-[252px]"
    >
      <div class="row-control">
        <label class="form-control w-full max-w-xs relative">
          <div class="label flex gap-2 justify-start">
            <span class="material-symbols-outlined"> flight_land </span>
            <span class="label-text">To</span>
          </div>
          <input
            type="text"
            placeholder="New york city"
            class="input input-bordered w-full max-w-xs"
            id="to_destination"
            formControlName="to_destination"
            name="to_destination"
            required
          />

          <ng-container
            *ngTemplateOutlet="
              autocompleteTemplate;
              context: { results: toResults, field: 'to_destination' }
            "
          ></ng-container>

          <div class="label">
            <span
              class="error-message label-text-alt text-red-600"
              *ngIf="
                flighSearchForm.get('to_destination')?.invalid &&
                (flighSearchForm.get('to_destination')?.dirty ||
                  flighSearchForm.get('to_destination')?.touched)
              "
            >
              {{ getErrorMessage("to_destination") }}
            </span>
          </div>
        </label>
      </div>

      <figure
        class="flex flex-col p-2 mt-7 text-lg bg-white rounded-xl h-[171px] w-[171px]"
      >
        <img
          loading="lazy"
          src="https://cdn.builder.io/api/v1/image/assets/TEMP/6655cded37a0d184135bb1e86f283624fb3cd1f0647a52aa9b399fbe088591a1?apiKey=6b158420ea1148c682b1835c67783cca&"
          alt="Singapore cityscape"
          class="object-contain w-full rounded-xl aspect-[1.3]"
        />
        <figcaption class="mt-2.5">Singapore</figcaption>
      </figure>
    </section>
  </form>
</div>

<ng-template #autocompleteTemplate let-results="results" let-field="field">
  <div
    *ngIf="results && results.length > 0"
    class="absolute z-10 w-full max-w-xs mt-24 bg-white shadow-lg rounded-md"
  >
    <ul class="py-1">
      <li
        *ngFor="let result of results"
        class="px-4 py-2 hover:bg-gray-100 cursor-pointer"
        (click)="selectResult(field, result)"
      >
        {{ result.presentation.title }}
      </li>
    </ul>
  </div>
</ng-template>
